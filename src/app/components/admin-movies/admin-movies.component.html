<div class="card">
    <p-table #dt1 [value]="movies" [rowHover]="true" dataKey="id" editMode="row" [rows]="10" [showCurrentPageReport]="true"
         [rowsPerPageOptions]="[10,25,50]" [loading]="loading" [paginator]="true"
         [resizableColumns]="true" styleClass="p-datatable-gridlines" [tableStyle]="{'min-width': '50rem'}"
        currentPageReportTemplate="Showing {{first}} to {{last}} of {{totalResults}} entries">
    
        <ng-template pTemplate="caption">
            <div class="flex">
                <h1>List Of Movies</h1>
            </div>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th  pResizableColumn pSortableColumn="id">ID<p-sortIcon field="id"></p-sortIcon></th>
                <th pResizableColumn pSortableColumn="moviesID">Movie ID<p-sortIcon field="moviesID"></p-sortIcon></th>
                <th pResizableColumn pSortableColumn="original_title">Movie Name<p-sortIcon
                        field="original_title"></p-sortIcon> </th>
                <th pResizableColumn pSortableColumn="poster_path">poster path<p-sortIcon
                        field="poster_path"></p-sortIcon></th>
                <th pResizableColumn pSortableColumn="origin_country">origin country<p-sortIcon
                        field="origin_country"></p-sortIcon></th>
                <th pResizableColumn pSortableColumn="popularity">popularity<p-sortIcon
                        field="popularity"></p-sortIcon></th>
                <th pResizableColumn pSortableColumn="vote_average">vote average<p-sortIcon
                        field="vote_average"></p-sortIcon></th>
                <th pResizableColumn pSortableColumn="vote_count">vote count<p-sortIcon
                        field="vote_count"></p-sortIcon></th>
                <th pResizableColumn pSortableColumn="release_date">release date <p-sortIcon
                        field="release_date"></p-sortIcon></th>
                <th pResizableColumn>Download</th>
                <!-- <th >Comments</th> -->
    
                <th ></th>
    
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-movie let-editing="editing" let-ri="rowIndex" let-expanded="expanded">
            <tr [pEditableRow]="movie">
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.id">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.id}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.moviesID">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.moviesID}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.original_title">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.original_title}}
                        </ng-template>
                    </p-cellEditor>
    
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.poster_path">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.poster_path}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.origin_country">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.origin_country}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.popularity">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.popularity}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.vote_average">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.vote_average}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.vote_count">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.vote_count}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="movie.release_date">
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{movie.release_date | date : "yyyy-MM--dd"}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <button type="button" pButton pRipple [pRowToggler]="movie" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                </td>
            
                <td>
                    <div class="flex align-items-center justify-content-center gap-2">
                        <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                             class="p-button-rounded p-button-text"></button>
                        <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                            (click)="onMovieRowEditSave(movie)"
                            class="p-button-rounded p-button-text p-button-success mr-2"></button>
                        <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"
                           
                            class="p-button-rounded p-button-text p-button-danger"></button>
                    </div>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-movie>
            <tr>
                <td colspan="12">
                    <div class="">
                        <p-table #dt1 [value]="movie.downloads" [rowHover]="true" dataKey="id" editMode="row">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th >ID</th>
                                    <th >Download Name </th>
                                    <th >Language</th>
                                    <th >Link</th>
                                    <th ></th>
    
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-download let-editing="editing" let-ri="rowIndex">
                            <tr [pEditableRow]="download">
                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="download.id">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{download.id}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>
                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="download.name">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{download.name}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>
                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="download.language">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{download.language}}
                                        </ng-template>
                                    </p-cellEditor>
    
                                </td>
                                <td>
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <input pInputText type="text" [(ngModel)]="download.download_link">
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{download.download_link}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>
    
                                <td>
                                    <div class="flex align-items-center justify-content-center gap-2">
                                        <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                                             class="p-button-rounded p-button-text"></button>
                                        <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                                            (click)="onDownloadRowEditSave(download.id,download)"
                                            class="p-button-rounded p-button-text p-button-success mr-2"></button>
                                        <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"
                                           
                                            class="p-button-rounded p-button-text p-button-danger"></button>
                                            <p-toolbar styleClass="mb-4 gap-2">
                                                <ng-template pTemplate="left">
                                                    <button pButton pRipple label="New" icon="pi pi-plus" class="p-button-success mr-2" (click)="openNew()"></button>
                                                    <button pButton pRipple [label]="Delete" icon="pi pi-trash" class="p-button-danger" (click)="deleteSelectedProducts()" [disabled]="!selectedProducts || !selectedProducts.length"></button>
                                                </ng-template>
                                        
                                                <ng-template pTemplate="right">
                                                    <p-fileUpload mode="basic" accept="image/*" [maxFileSize]="1000000" label="Import" chooseLabel="Import" class="mr-2 inline-block"></p-fileUpload>
                                                    <button pButton pRipple label="Export" icon="pi pi-upload" class="p-button-help"></button>
                                                </ng-template>
                                            </p-toolbar>
                                        </div>
                                </td>
                            </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="6">There are no download for this movie yet.</td>
                                </tr>
                            </ng-template>
                       </p-table>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>

</div>